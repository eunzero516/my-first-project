<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¹µê³°ì´ ê·¼ë¬´í‘œ</title>
    <style>
        :root {
            --primary: #4a90e2; 
            --holiday: #ff6b6b; /* ì¼ìš”ì¼/ê³µíœ´ì¼ ë¹¨ê°„ìƒ‰ */
            --sat-color: #1c7ed6; /* í† ìš”ì¼ íŒŒë€ìƒ‰ */
            --user-holiday-cell-bg: #f2fdf7; /* ì§ì ‘ ì²´í¬í•œ íœ´ì¼ ì—°ë…¹ìƒ‰ ë°°ê²½ */
            --user-holiday-text: #099268; 
            --border: #e9ecef;
            --am-color: #1971c2; --am-bg: #e7f5ff;
            --pm-color: #fd7e14; --pm-bg: #fff4e6;
            --bg-standard: #f8f9fa; /* ì „ì²´ ë°°ê²½ìƒ‰ */
            --text-dark: #333;
        }

        body { font-family: 'Pretendard', -apple-system, sans-serif; background-color: var(--bg-standard); display: flex; flex-direction: column; align-items: center; padding: 10px; margin: 0; }
        .app-title { font-size: 1.6rem; font-weight: 800; color: var(--text-dark); margin: 10px 0; letter-spacing: -1px; display: flex; align-items: center; gap: 8px; }
        .app-logo { width: 45px; height: auto; }

        .calendar-container { width: 100%; max-width: 950px; background: white; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.05); overflow: hidden; margin-bottom: 15px; }
        
        .header { display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; background: #fff; }
        .month-selector { display: flex; gap: 4px; align-items: center; }
        .month-selector select { 
            font-size: 1.1rem; font-weight: 800; color: var(--text-dark); border: none; 
            background: transparent; cursor: pointer; outline: none; padding: 2px;
            border-radius: 5px; transition: background 0.2s;
        }
        .month-selector select:hover { background: #f1f3f5; }
        
        .btn-today {
            background: #f1f3f5; color: var(--text-dark); border: 1px solid #dee2e6;
            padding: 4px 10px; border-radius: 6px; font-size: 0.75rem; font-weight: 700;
            cursor: pointer; margin-left: 4px; transition: all 0.2s;
        }
        .btn-today:hover { background: var(--text-dark); color: white; border-color: var(--text-dark); }

        .nav-buttons button { cursor: pointer; border: 1px solid #ddd; background: white; padding: 5px 12px; border-radius: 6px; font-weight: 600; font-size: 0.8rem; }

        .weekdays { display: grid; grid-template-columns: repeat(7, minmax(0, 1fr)); background: #fafbfc; border-top: 1px solid var(--border); border-bottom: 1px solid var(--border); }
        .weekday { text-align: center; padding: 8px 0; font-size: 0.7rem; color: #868e96; font-weight: bold; }
        .weekday:nth-child(1) { color: var(--holiday); }
        .weekday:nth-child(7) { color: var(--sat-color); }

        .calendar-grid { display: grid; grid-template-columns: repeat(7, minmax(0, 1fr)); grid-auto-rows: 88px; }
        .day-cell { border-right: 1px solid var(--border); border-bottom: 1px solid var(--border); padding: 4px; cursor: pointer; display: flex; flex-direction: column; gap: 2px; min-width: 0; overflow: hidden; background: #fff; transition: background-color 0.2s; }
        .day-cell:nth-child(7n) { border-right: none; }
        .day-cell:hover { background: #f8f9fa; }
        
        .user-holiday-active { background-color: var(--user-holiday-cell-bg) !important; }

        .day-num { font-size: 0.8rem; font-weight: 700; color: #495057; display: flex; align-items: center; }
        .today-circle {
            background: var(--text-dark); color: white !important;
            width: 22px; height: 22px; display: inline-flex; align-items: center; justify-content: center;
            border-radius: 50%; margin-left: -2px;
        }

        .holiday-date { color: var(--holiday) !important; }
        .saturday-date { color: var(--sat-color) !important; }
        .holiday-name { font-size: 0.55rem; color: var(--holiday); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; line-height: 1; }
        .other-month { opacity: 0.2; }

        .item { font-size: 0.62rem; padding: 1px 3px; border-radius: 3px; font-weight: 700; text-align: center; white-space: normal; word-break: keep-all; line-height: 1.1; display: block; }
        .item-holiday { background: transparent; color: var(--user-holiday-text); border: 1px solid #c3fae8; }
        .item-am { background: var(--am-bg); color: var(--am-color); border: 1px solid #a5d8ff; }
        .item-pm { background: var(--pm-bg); color: var(--pm-color); border: 1px solid #ffd8a8; }
        .item-memo { color: #adb5bd; font-size: 0.58rem; font-style: italic; margin-top: auto; padding-top: 1px; border-top: 1px dashed #eee; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; line-height: 1.2; word-break: break-all; }

        .stats-container { width: 100%; max-width: 950px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
        .stat-card { background: #fff; padding: 12px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); display: flex; flex-direction: column; gap: 5px; border: 1px solid #eee; border-left-width: 5px; min-width: 0; }
        .card-total { border-left-color: #343a40; }
        .card-am { border-left-color: var(--am-color); }
        .card-pm { border-left-color: var(--pm-color); }
        .stat-card h4 { margin: 0; font-size: 0.65rem; color: #868e96; font-weight: 700; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .stat-card .value { font-size: 1rem; font-weight: 800; color: var(--text-dark); word-break: keep-all; }
        .stat-card .sub-value { font-size: 0.65rem; color: #495057; font-weight: 500; word-break: keep-all; }
        .highlight-holiday { color: var(--user-holiday-text); font-weight: bold; }

        #modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 50px rgba(0,0,0,0.3); z-index: 100; width: 85%; max-width: 320px; }
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); z-index: 99; backdrop-filter: blur(3px); }
        
        .form-group { margin-bottom: 22px; } 
        .form-group label { display: block; margin-bottom: 10px; font-weight: bold; font-size: 0.95rem; }
        
        textarea { width: 100%; padding: 12px; border: 1px solid #dee2e6; border-radius: 10px; font-size: 0.95rem; resize: none; box-sizing: border-box; }
        .btn-toggle-group { display: flex; gap: 8px; }
        .btn-toggle { flex: 1; padding: 12px; border: 1px solid #dee2e6; border-radius: 10px; background: white; cursor: pointer; font-weight: bold; font-size: 0.9rem; }
        
        .btn-toggle.active-blue { background: var(--primary); color: white; border-color: var(--primary); }
        .btn-toggle.active-orange { background: var(--pm-color); color: white; border-color: var(--pm-color); }
        .btn-toggle.active-gray { background: var(--text-dark); color: white; border-color: var(--text-dark); }
        
        .btn-save { width: 100%; background: var(--text-dark); color: white; border: none; padding: 15px; border-radius: 10px; font-weight: bold; font-size: 1.1rem; margin-top: 10px; cursor: pointer; }
    </style>
</head>
<body>

    <h1 class="app-title">
        <img src="https://postfiles.pstatic.net/MjAyNTEyMjZfMjgg/MDAxNzY2NzA1ODkxNDI4.jwR_hmBeX73gNUybaFzK1piDE3Dp6NPgib30YcaMvaQg.7BxiiFsCLAVzNkdQdORGL7WAVlKYT_a-_aaaIvT47gsg.PNG/image_1.png?type=w773" 
             alt="ë¡œê³ " class="app-logo" referrerpolicy="no-referrer">
        ë¹µê³°ì´ ê·¼ë¬´í‘œ
    </h1>

    <div class="calendar-container">
        <div class="header">
            <div class="nav-buttons"><button onclick="moveMonth(-1)">â—€</button></div>
            <div class="month-selector">
                <select id="yearSelect" onchange="jumpToDate()"></select>
                <select id="monthSelect" onchange="jumpToDate()"></select>
                <button onclick="jumpToToday()" class="btn-today">ì˜¤ëŠ˜</button>
            </div>
            <div class="nav-buttons"><button onclick="moveMonth(1)">â–¶</button></div>
        </div>
        <div class="weekdays">
            <div class="weekday">ì¼</div><div class="weekday">ì›”</div><div class="weekday">í™”</div>
            <div class="weekday">ìˆ˜</div><div class="weekday">ëª©</div><div class="weekday">ê¸ˆ</div>
            <div class="weekday">í† </div>
        </div>
        <div class="calendar-grid" id="grid"></div>
    </div>

    <div class="stats-container">
        <div class="stat-card card-total">
            <h4 id="statMonthTitle">ê·¼ë¬´ í˜„í™©</h4>
            <div class="value" id="statTotalDaysValue">ì´ 0ì¼ / 0ì¼</div>
            <div class="sub-value" id="statHolidayDetail">íœ´ì¼: <span class="highlight-holiday">0ì¼</span></div>
        </div>
        <div class="stat-card card-am">
            <h4>ì˜¤ì „ë°˜ ìƒì„¸</h4>
            <div class="value" id="statAMTotal">0ì¼</div>
            <div class="sub-value" id="statAMDetail">2íšŒ:0, 3íšŒ:0</div>
        </div>
        <div class="stat-card card-pm">
            <h4>ì˜¤í›„ë°˜ ìƒì„¸</h4>
            <div class="value" id="statPMTotal">0ì¼</div>
            <div class="sub-value" id="statPMDetail">2íšŒ:0, 3íšŒ:0</div>
        </div>
    </div>

    <div class="overlay" id="overlay" onclick="closeModal()"></div>
    <div id="modal">
        <h3 id="modalDate" style="margin: 0 0 20px 0; font-size: 1.2rem;">ë‚ ì§œ ì„ íƒ</h3>
        <div class="form-group">
            <label style="display: flex; align-items: center; cursor: pointer;">
                <input type="checkbox" id="isHoliday" onchange="updateButtons()" style="width: 20px; height: 20px; margin-right: 10px;"> ğŸŒ´ íœ´ì¼ ì²´í¬
            </label>
        </div>
        <div class="form-group">
            <label id="shiftLabel">ê·¼ë¬´ íƒ€ì„</label>
            <div class="btn-toggle-group">
                <button class="btn-toggle" id="shiftAM" onclick="setShift('ì˜¤ì „')">ì˜¤ì „</button>
                <button class="btn-toggle" id="shiftPM" onclick="setShift('ì˜¤í›„')">ì˜¤í›„</button>
            </div>
        </div>
        <div class="form-group">
            <label id="tangLabel">ì—…ë¬´ íšŸìˆ˜</label>
            <div class="btn-toggle-group">
                <button class="btn-toggle" id="tang2" onclick="setTang(2)">2íšŒ</button>
                <button class="btn-toggle" id="tang3" onclick="setTang(3)">3íšŒ</button>
            </div>
        </div>
        <div class="form-group">
            <label>ë©”ëª¨</label>
            <textarea id="memo" rows="2" placeholder="ê°„ë‹¨í•œ ë©”ëª¨ ì…ë ¥"></textarea>
        </div>
        <button class="btn-save" onclick="save()">ì €ì¥ ì™„ë£Œ</button>
    </div>

<script>
    let viewDate = new Date();
    const STORAGE_KEY = 'bbanggom_stable_data';
    let db = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};
    let activeKey = "", selectedShift = null, selectedTang = null;

    // 2025-2030 í•œêµ­ ê³µíœ´ì¼ ì™„ë²½ ë°˜ì˜
    const baseHolidays = {
        // 2025
        "2025-01-01": "ì‹ ì •", "2025-01-28": "ì„¤ë‚ ì—°íœ´", "2025-01-29": "ì„¤ë‚ ", "2025-01-30": "ì„¤ë‚ ì—°íœ´", "2025-03-01": "ì‚¼ì¼ì ˆ", "2025-03-03": "ëŒ€ì²´ê³µíœ´ì¼", "2025-05-05": "ì–´ë¦°ì´ë‚ /ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚ ", "2025-05-06": "ëŒ€ì²´ê³µíœ´ì¼", "2025-06-06": "í˜„ì¶©ì¼", "2025-08-15": "ê´‘ë³µì ˆ", "2025-10-03": "ê°œì²œì ˆ", "2025-10-06": "ì¶”ì„", "2025-10-09": "í•œê¸€ë‚ ", "2025-12-25": "í¬ë¦¬ìŠ¤ë§ˆìŠ¤",
        // 2026-2030
        "2026-02-17": "ì„¤ë‚ ", "2026-05-24": "ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚ ", "2026-09-25": "ì¶”ì„", "2026-12-25": "í¬ë¦¬ìŠ¤ë§ˆìŠ¤",
        "2027-02-07": "ì„¤ë‚ ", "2027-05-13": "ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚ ", "2027-09-15": "ì¶”ì„", "2027-12-25": "í¬ë¦¬ìŠ¤ë§ˆìŠ¤",
        "2028-01-27": "ì„¤ë‚ ", "2028-05-02": "ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚ ", "2028-10-03": "ì¶”ì„/ê°œì²œì ˆ", "2028-12-25": "í¬ë¦¬ìŠ¤ë§ˆìŠ¤",
        "2029-02-13": "ì„¤ë‚ ", "2029-05-20": "ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚ ", "2029-09-22": "ì¶”ì„", "2029-12-25": "í¬ë¦¬ìŠ¤ë§ˆìŠ¤",
        "2030-02-03": "ì„¤ë‚ ", "2030-05-09": "ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚ ", "2030-09-12": "ì¶”ì„", "2030-12-25": "í¬ë¦¬ìŠ¤ë§ˆìŠ¤"
    };

    function initSelects(year, month) {
        const ySel = document.getElementById('yearSelect'), mSel = document.getElementById('monthSelect');
        ySel.innerHTML = ''; mSel.innerHTML = '';
        // 2025ë…„ë¶€í„° 2030ë…„ê¹Œì§€ ì„ íƒ ê°€ëŠ¥í•˜ë„ë¡ ìˆ˜ì •
        for (let y = 2025; y <= 2030; y++) {
            const opt = document.createElement('option'); opt.value = y; opt.innerText = `${y}ë…„`;
            if (y === year) opt.selected = true; ySel.appendChild(opt);
        }
        for (let m = 1; m <= 12; m++) {
            const opt = document.createElement('option'); opt.value = m - 1; opt.innerText = `${m}ì›”`;
            if (m - 1 === month) opt.selected = true; mSel.appendChild(opt);
        }
    }

    function jumpToDate() {
        viewDate = new Date(parseInt(document.getElementById('yearSelect').value), parseInt(document.getElementById('monthSelect').value), 1);
        render();
    }

    function jumpToToday() { viewDate = new Date(); render(); }

    function render() {
        const grid = document.getElementById('grid');
        grid.innerHTML = '';
        const year = viewDate.getFullYear(), month = viewDate.getMonth();
        const lastDate = new Date(year, month + 1, 0).getDate();
        const realToday = new Date(); 
        
        initSelects(year, month);

        const firstDay = new Date(year, month, 1).getDay();
        const totalCells = (firstDay + lastDate) > 35 ? 42 : 35;
        const startDate = new Date(year, month, 1);
        startDate.setDate(startDate.getDate() - firstDay);

        let stats = { total: 0, holiday: 0, am: 0, am2: 0, am3: 0, pm: 0, pm2: 0, pm3: 0 };

        for (let i = 0; i < totalCells; i++) {
            const date = new Date(startDate);
            date.setDate(startDate.getDate() + i);
            const key = `${date.getFullYear()}-${String(date.getMonth()+1).padStart(2,'0')}-${String(date.getDate()).padStart(2,'0')}`;
            const isThisMonth = date.getMonth() === month;
            const dayOfWeek = date.getDay();
            const isToday = date.getFullYear() === realToday.getFullYear() && date.getMonth() === realToday.getMonth() && date.getDate() === realToday.getDate();
            
            const cell = document.createElement('div');
            cell.className = `day-cell ${isThisMonth ? '' : 'other-month'}`;
            const holidayName = baseHolidays[key];
            
            let dateClass = 'day-num';
            if (holidayName || dayOfWeek === 0) dateClass += ' holiday-date';
            else if (dayOfWeek === 6) dateClass += ' saturday-date';
            
            const dateNumDisplay = isToday ? `<span class="today-circle">${date.getDate()}</span>` : date.getDate();
            let content = `<div class="${dateClass}">${dateNumDisplay}</div>`;
            if (holidayName) content += `<div class="holiday-name">${holidayName}</div>`;

            if (db[key]) {
                const data = db[key];
                if (isThisMonth) {
                    if (data.isHoliday) stats.holiday++;
                    else if (data.shift) {
                        stats.total++;
                        if (data.shift === 'ì˜¤ì „') { stats.am++; if (data.count == 2) stats.am2++; else if (data.count == 3) stats.am3++; }
                        else { stats.pm++; if (data.count == 2) stats.pm2++; else if (data.count == 3) stats.pm3++; }
                    }
                }
                if (data.isHoliday) {
                    cell.classList.add('user-holiday-active');
                    content += `<div class="item item-holiday">ğŸŒ´ íœ´ì¼</div>`;
                }
                else if (data.shift) { 
                    const shiftClass = data.shift === 'ì˜¤ì „' ? 'item-am' : 'item-pm'; 
                    content += `<div class="item ${shiftClass}">${data.shift} ${data.count}íšŒ</div>`; 
                }
                if (data.memo) content += `<div class="item-memo">${data.memo}</div>`;
            }
            cell.innerHTML = content;
            cell.onclick = () => openModal(key);
            grid.appendChild(cell);
        }
        updateStatsUI(stats, year, month + 1, lastDate);
    }

    function updateStatsUI(s, y, m, ld) {
        document.getElementById('statMonthTitle').innerText = `${y}ë…„ ${m}ì›”`;
        document.getElementById('statTotalDaysValue').innerText = `ì´ ${s.total}ì¼ / ${ld}ì¼`;
        document.getElementById('statHolidayDetail').innerHTML = `íœ´ì¼: <span class="highlight-holiday">${s.holiday}ì¼</span>`;
        document.getElementById('statAMTotal').innerText = `${s.am}ì¼`;
        document.getElementById('statAMDetail').innerText = `2íšŒ:${s.am2}, 3íšŒ:${s.am3}`;
        document.getElementById('statPMTotal').innerText = `${s.pm}ì¼`;
        document.getElementById('statPMDetail').innerText = `2íšŒ:${s.pm2}, 3íšŒ:${s.pm3}`;
    }

    function setShift(v) { selectedShift = (selectedShift === v) ? null : v; updateButtons(); }
    function setTang(v) { selectedTang = (selectedTang === v) ? null : v; updateButtons(); }
    function updateButtons() {
        const isH = document.getElementById('isHoliday').checked;
        if (isH) { selectedShift = null; selectedTang = null; }
        const btns = [document.getElementById('shiftAM'), document.getElementById('shiftPM'), document.getElementById('tang2'), document.getElementById('tang3')];
        btns.forEach(b => b.disabled = isH);
        document.getElementById('shiftAM').className = 'btn-toggle' + (selectedShift === 'ì˜¤ì „' ? ' active-blue' : '');
        document.getElementById('shiftPM').className = 'btn-toggle' + (selectedShift === 'ì˜¤í›„' ? ' active-orange' : '');
        document.getElementById('tang2').className = 'btn-toggle' + (selectedTang === 2 ? ' active-gray' : '');
        document.getElementById('tang3').className = 'btn-toggle' + (selectedTang === 3 ? ' active-gray' : '');
    }
    function openModal(k) {
        activeKey = k; const data = db[k] || { isHoliday: false, shift: null, count: null, memo: '' };
        document.getElementById('modalDate').innerText = k; document.getElementById('isHoliday').checked = data.isHoliday;
        document.getElementById('memo').value = data.memo; selectedShift = data.shift; selectedTang = data.count;
        updateButtons(); document.getElementById('modal').style.display = 'block'; document.getElementById('overlay').style.display = 'block';
    }
    function closeModal() { document.getElementById('modal').style.display = 'none'; document.getElementById('overlay').style.display = 'none'; }
    function save() {
        db[activeKey] = { isHoliday: document.getElementById('isHoliday').checked, shift: selectedShift, count: selectedTang, memo: document.getElementById('memo').value };
        localStorage.setItem(STORAGE_KEY, JSON.stringify(db));
        render(); closeModal();
    }
    function moveMonth(o) { viewDate.setMonth(viewDate.getMonth() + o); render(); }
    render();
</script>
</body>
</html>
