<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ğŸº ì•Œì½”ì˜¬ ë””í†¡ìŠ¤ ê³„ì‚°ê¸° & ì €ë„</title>
  <meta name="description" content="í•´ë… ê³„ì‚°ê¸° ë° ë””í†¡ìŠ¤ ì €ë„ í†µí•© ë²„ì „ì…ë‹ˆë‹¤. ì°¸ê³ ìš©ìœ¼ë¡œë§Œ ì‚¬ìš©í•˜ì„¸ìš”." />
  
  <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" />

  <style>
    /* ===== í°íŠ¸ ë° ì»¬ëŸ¬ ë³€ìˆ˜ ===== */
    :root{
      --bg: #F7F9FB;
      --card: #FFFFFF;
      --primary: #5989F7;
      --accent: #27AE60;
      --danger: #E74C3C;
      --muted: #6B7280;
      --border: #E6EEF6;
      --radius: 14px;
      --shadow: 0 6px 20px rgba(16,24,40,0.06);
      /* íƒ­ë°” ë†’ì´ (ëŒ€ëµ 50px + íŒ¨ë”©) */
      --tab-bar-height: 54px;
      font-family: Pretendard, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans KR", "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background: linear-gradient(180deg,var(--bg), #F4F7FB);
      color:#16202A;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      display:flex;
      flex-direction: column;
      justify-content:flex-start;
      /* ìƒë‹¨ íƒ­ë°” ë†’ì´ë§Œí¼ íŒ¨ë”© ì¶”ê°€ */
      padding: calc(var(--tab-bar-height) + 28px) 18px 28px; 
      font-size:16px;
      line-height:1.4;
    }

    /* ===== ì»¨í…Œì´ë„ˆ ===== */
    .app {
      width:100%;
      max-width:520px;
      margin: 0 auto;
    }

    /* ===== í—¤ë” ë° íƒ€ì´í‹€ (ì½˜í…ì¸  í—¤ë”ëŠ” íƒ­ë°” ì•„ë˜ë¡œ ë‚´ë ¤ì˜´) ===== */
    header {
      text-align:center;
      margin-bottom:18px;
    }
    .title {
      display:flex;
      align-items:center;
      justify-content:center;
      gap:12px;
      font-weight:700;
      color:var(--primary);
      font-size:1.6rem;
    }
    .subtitle {
      color:var(--muted);
      font-size:0.95rem;
      margin-top:6px;
    }

    /* ===== ì¹´ë“œ ìŠ¤íƒ€ì¼ ===== */
    .card {
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:18px;
      margin-bottom:14px;
      border:1px solid var(--border);
    }
    .card + .card { margin-top:10px; }

    .section-title {
      font-size:0.98rem;
      font-weight:600;
      margin-bottom:10px;
      color:#243447;
    }

    /* ===== í¼ ë° ì…ë ¥ í•„ë“œ ===== */
    label.small { display:block; font-size:0.85rem; color:var(--muted); margin-bottom:6px; }
    input[type="number"], select, .input-text {
      width:100%; padding:12px 14px; border-radius:10px; border:1px solid #E6EEF6; background:#FBFDFF;
      font-size:1rem; color:#102027; outline:none; transition:box-shadow .15s ease, border-color .15s ease;
    }
    input[type="number"]:focus, select:focus, .input-text:focus{
      box-shadow:0 6px 18px rgba(89,137,247,0.12); border-color:var(--primary);
    }

    /* ë¼ë””ì˜¤ ê·¸ë£¹ (í”Œë« ìŠ¤íƒ€ì¼) */
    .radio-group { display:flex; gap:10px; flex-wrap:wrap; }
    .radio-input { display:none; }
    .radio-label {
      flex:1; text-align:center; padding:10px 8px; border-radius:10px; border:2px solid #E6EEF6; cursor:pointer;
      user-select:none; font-weight:600; color:#334155; background:var(--card);
    }
    .radio-input:checked + .radio-label{ background:var(--primary); color:white; border-color:var(--primary); box-shadow:none; }

    /* ì„­ì·¨ëŸ‰ ì»¨íŠ¸ë¡¤ */
    .volume { display:flex; gap:10px; align-items:center; }
    .volume .unit-select { width:45%; min-width:110px; }
    .volume .qty { flex:1; }
    .ml-display { text-align:right; font-size:0.95rem; color:var(--muted); margin-top:6px; }

    /* ì‹œê°„ ì…ë ¥ í•„ë“œ ë ˆì´ì•„ì›ƒ */
    .time-inputs {
        display: flex;
        flex-direction: column; /* ì„¸ë¡œë¡œ ë‘ í–‰ì„ ë°°ì¹˜ */
        gap: 8px; /* í–‰ ê°„ê²© */
        margin-top: 10px;
    }
    .time-row {
        display: flex;
        gap: 8px; /* í•­ëª© ê°„ê²© */
    }
    .time-row select {
        padding: 8px 5px; /* ì‹œê°„ ì„ íƒ ë°•ìŠ¤ëŠ” íŒ¨ë”© ì¶•ì†Œ */
        font-size: 0.95rem;
        flex-grow: 1;
        min-width: 50px;
        text-align: center;
    }
    .duration-select select {
        width: 100%;
    }


    /* ë²„íŠ¼ (í”Œë« ìŠ¤íƒ€ì¼) */
    .btn {
      display:inline-block; width:100%; border:0; padding:14px; border-radius:12px; font-weight:700;
      font-size:1.05rem; cursor:pointer; background:var(--primary); color:white; box-shadow:none;
    }
    .btn:active{ transform:translateY(1px) }

    /* ê²°ê³¼ ì¹´ë“œ */
    .result .big { text-align:center; font-size:1.5rem; font-weight:800; color:var(--accent); }
    .result .sub { text-align:center; color:#1B3B4D; font-weight:600; }
    .result .meta {
      display:flex; justify-content:space-between; gap:12px; flex-wrap:wrap; color:#4B5860;
      font-size:0.95rem; margin-top:6px;
    }
    .result .meta div { min-width:140px; }

    /* ê²½ê³  ë°•ìŠ¤ */
    .disclaimer {
      background:#FFF4F4; border-left:6px solid var(--danger); padding:12px; border-radius:8px;
      color:#6B2630; font-size:0.92rem; line-height:1.45;
    }
    .muted-note { font-size:0.88rem; color:var(--muted) }


    /* ===== ë””í†¡ìŠ¤ ì €ë„ ìŠ¤íƒ€ì¼ ===== */
    .journal-list { list-style:none; padding:0; margin:0; }
    .journal-item {
        display:flex; align-items:center; gap:15px; padding:15px 0; border-bottom:1px solid var(--border);
        cursor:pointer; transition:background-color 0.1s;
    }
    .journal-item:hover { background-color: #f9f9f9; }
    .journal-item:last-child { border-bottom:none; }
    .journal-icon {
        font-size:1.5rem; width:40px; height:40px; background: #F0F5FF; border-radius: 8px;
        display: flex; align-items: center; justify-content: center;
    }
    .journal-content h3 { margin:0; font-size:1rem; font-weight:600; color:#16202A; }
    .journal-content p { margin:3px 0 0; font-size:0.85rem; color:var(--muted); }
    
    /* ì €ë„ ìƒì„¸ í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
    .detail-card { margin-top: 15px; padding: 25px; }
    .detail-card h2 { font-size: 1.4rem; color: #16202A; margin-top: 0; margin-bottom: 15px; }
    .detail-card h3 { font-size: 1.1rem; color: var(--primary); margin-top: 20px; margin-bottom: 8px; }
    .detail-card p { margin-bottom: 12px; }
    .detail-card ul { padding-left: 20px; }
    .detail-card li { margin-bottom: 5px; }

    .back-button {
        display: inline-flex; align-items: center; gap: 5px; margin-bottom: 15px;
        color: var(--primary); font-weight: 600; text-decoration: none;
    }
    .back-button:hover { text-decoration: underline; }


    /* ===== íƒ­ë°” ìŠ¤íƒ€ì¼ (ìƒë‹¨ ê³ ì • ë° ì¤‘ì•™ ì •ë ¬) ===== */
    .tab-bar {
        position:fixed; 
        top:0; /* ìƒë‹¨ ê³ ì • */
        left: 50%; /* ì¤‘ì•™ ì •ë ¬ ì‹œì‘ì  */
        transform: translateX(-50%); /* ì¤‘ì•™ ì •ë ¬ */
        width: 100%;
        max-width: 520px; /* .appì˜ ìµœëŒ€ ë„ˆë¹„ì™€ ì¼ì¹˜ */
        height: var(--tab-bar-height);
        display:flex; justify-content:center;
        background:var(--card); 
        border-bottom:1px solid var(--border); /* í•˜ë‹¨ í…Œë‘ë¦¬ */
        box-shadow: 0 2px 8px rgba(0,0,0,0.08); /* ì•„ë˜ìª½ ê·¸ë¦¼ì */
        padding: 0; 
        z-index:1000;
        margin: 0 auto;
    }
    .tab-item {
        display:flex;
        flex-direction:row; /* ì•„ì´ì½˜ê³¼ í…ìŠ¤íŠ¸ë¥¼ ê°€ë¡œë¡œ ë°°ì¹˜ */
        align-items:center;
        justify-content:center;
        text-decoration:none;
        color:var(--muted);
        font-size:0.9rem;
        font-weight:700;
        flex: 1; /* ë„ˆë¹„ë¥¼ ê· ë“±í•˜ê²Œ ë‚˜ëˆ” */
        gap: 6px;
        transition:color 0.2s;
        border-bottom: 3px solid transparent;
    }
    .tab-item.active { 
        color:var(--primary);
        border-bottom: 3px solid var(--primary); /* í™œì„±í™” íƒ­ ì•„ë˜ì¤„ */
    }
    .tab-item span:first-child { 
        font-size:1.1rem; /* ì•„ì´ì½˜ í¬ê¸° ì¡°ì • */
    }
    .tab-item.active span { 
        transform: none; /* ì•„ì´ì½˜ ì• ë‹ˆë©”ì´ì…˜ ì œê±° */
    }

    /* ë°˜ì‘í˜• ë° ì¤‘ì•™ ì •ë ¬ */
    @media(min-width:520px){
        body { padding-top: calc(var(--tab-bar-height) + 28px); }
        .tab-bar { max-width: 520px; }
    }
    @media(min-width:720px){
      body{padding: calc(var(--tab-bar-height) + 36px) 18px 28px}
      .app { max-width:600px;}
      .title { font-size:1.9rem; }
      .result .big { font-size:1.8rem; }
      .tab-bar { max-width: 600px; }
    }
  </style>
</head>
<body>
  <main class="app" role="main" aria-labelledby="app-title">
    
    <div id="calculatorContent">
        <header>
          <div class="title" id="app-title">ğŸº ì•Œì½”ì˜¬ í•´ë… ê³„ì‚°ê¸°</div>
          <div class="subtitle">ì…ë ¥í•œ ì •ë³´ë¡œ ì˜ˆìƒ í•´ë… ì‹œê°„ê³¼ ì™„ë£Œ ì‹œê°ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤. (ì°¸ê³ ìš©)</div>
        </header>
    
        <section class="card" aria-label="ì…ë ¥ ì„¹ì…˜">
            <div class="section-title">ê¸°ë³¸ ì •ë³´</div>

            <div style="margin-bottom:12px;">
                <label class="small">ì„±ë³„</label>
                <div class="radio-group" role="radiogroup" aria-label="ì„±ë³„ ì„ íƒ">
                    <input class="radio-input" type="radio" id="gender-male" name="gender" value="male" checked>
                    <label class="radio-label" for="gender-male">ğŸ§‘ ë‚¨ì„±</label>
                    <input class="radio-input" type="radio" id="gender-female" name="gender" value="female">
                    <label class="radio-label" for="gender-female">ğŸ‘© ì—¬ì„±</label>
                </div>
            </div>

            <div style="margin-top:6px">
                <label class="small" for="weight">ì²´ì¤‘ (kg)</label>
                <input id="weight" type="number" inputmode="decimal" step="0.1" min="20" max="300" placeholder="ì˜ˆ: 70.5" aria-describedby="weightHelp" />
                <div id="weightHelp" class="muted-note">ì •í™•í• ìˆ˜ë¡ ê³„ì‚° ê²°ê³¼ê°€ ë” í˜„ì‹¤ì ì…ë‹ˆë‹¤.</div>
            </div>
        </section>

        <section class="card" aria-label="ì£¼ì¢… ë° ë„ìˆ˜">
            <div class="section-title">ì£¼ì¢… & ë„ìˆ˜</div>
            <div style="margin-bottom:10px;">
                <label class="small">ì£¼ì¢… ì„ íƒ</label>
                <div class="radio-group" id="drinkTypeGroup" role="radiogroup" aria-label="ì£¼ì¢… ì„ íƒ">
                    <input class="radio-input" type="radio" id="drink-soju" name="drinkType" value="soju" checked>
                    <label class="radio-label" for="drink-soju">ì†Œì£¼</label>
                    <input class="radio-input" type="radio" id="drink-beer" name="drinkType" value="beer">
                    <label class="radio-label" for="drink-beer">ë§¥ì£¼</label>
                    <input class="radio-input" type="radio" id="drink-wine" name="drinkType" value="wine">
                    <label class="radio-label" for="drink-wine">ì™€ì¸</label>
                    <input class="radio-input" type="radio" id="drink-whiskey" name="drinkType" value="whiskey">
                    <label class="radio-label" for="drink-whiskey">ìœ„ìŠ¤í‚¤</label>
                    <input class="radio-input" type="radio" id="drink-custom" name="drinkType" value="custom">
                    <label class="radio-label" for="drink-custom">ê¸°íƒ€</label>
                </div>
            </div>
            <div>
                <label class="small" for="alcoholContent">ë„ìˆ˜ (%)</label>
                <input id="alcoholContent" class="input-text" type="number" step="0.1" min="0" placeholder="ìë™ ì…ë ¥ ë˜ëŠ” ì§ì ‘ ì…ë ¥" />
            </div>
        </section>

        <section class="card" aria-label="ì„­ì·¨ëŸ‰">
            <div class="section-title">ì„­ì·¨ëŸ‰</div>
            <div class="volume">
                <div class="qty">
                    <label class="small" for="unitVolume">ìˆ˜ëŸ‰</label>
                    <input id="unitVolume" type="number" step="1" min="0" placeholder="ìˆ˜ëŸ‰ ë˜ëŠ” ì´ mL ì…ë ¥" />
                </div>
                <div class="unit-select">
                    <label class="small" for="unitType">ë‹¨ìœ„</label>
                    <select id="unitType" aria-label="ë‹¨ìœ„ ì„ íƒ"></select>
                </div>
            </div>
            <div class="ml-display" aria-live="polite">ì´ í™˜ì‚°ëŸ‰: <strong id="displayML">0</strong> mL</div>
            <div style="margin-top:12px" class="muted-note">ì˜ˆ: ë§¥ì£¼ ìº”(500mL) 1ê°œ â†’ 500 mL</div>
        </section>
        
        <section class="card" id="timeInputCard" aria-label="ì¸¡ì • ì‹œê°„ ì…ë ¥">
            <div class="section-title">ì¸¡ì • ì‹œê°„</div>
            
            <label class="small">ì¸¡ì • ì‹œì‘ ì‹œê° (ìŒì£¼ ì¢…ë£Œ ì‹œì )</label>
            <div class="time-inputs" style="margin-bottom: 15px;">
                <div class="time-row time-row-date">
                    <select id="inputYear" aria-label="ë…„"></select>
                    <select id="inputMonth" aria-label="ì›”"></select>
                    <select id="inputDay" aria-label="ì¼"></select>
                </div>
                <div class="time-row time-row-time">
                    <select id="inputHour" aria-label="ì‹œ"></select>
                    <select id="inputMinute" aria-label="ë¶„"></select>
                </div>
            </div>
            
            <label class="small" for="inputDrinkingDuration">ì´ ìŒì£¼ ì‹œê°„</label>
            <div class="duration-select">
                <select id="inputDrinkingDuration" aria-label="ì´ ìŒì£¼ ì‹œê°„"></select>
            </div>
            <div class="muted-note" style="margin-top: 6px;">
                *ìŒì£¼ ì‹œê°„ì´ ê¸¸ìˆ˜ë¡ í•´ë… ì‹œê°„ì´ ì§§ì•„ì§‘ë‹ˆë‹¤.
            </div>
        </section>
        <button id="calculateBtn" class="btn" type="button" aria-pressed="false">ì¸¡ì •í•˜ê¸°</button>

        <section id="resultArea" class="card fade-in" style="margin-top:14px" aria-live="polite">
            <div id="resultInitial" class="result">
                <div class="section-title">ê²°ê³¼</div>
                <div class="muted-note">ì •ë³´ë¥¼ ì…ë ¥í•˜ê³  'ì¸¡ì •í•˜ê¸°' ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</div>
            </div>
            <div id="resultOutput" style="display:none"></div>
        </section>

        <section style="margin-top:10px">
            <div class="disclaimer">
                <strong>âš ï¸ ì£¼ì˜</strong>
                ë³¸ ê³„ì‚°ê¸°ëŠ” ì´ë¡ ì ì¸ ì¶”ì •ì¹˜ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ê°œì¸ì˜ ì‹ ì²´ ìƒíƒœ, ë³µìš© ì•½ë¬¼, ê°„ ê¸°ëŠ¥, ìœ ì „ì  ì°¨ì´ ë“±ì— ë”°ë¼ ì‹¤ì œ í•´ë… ì‹œê°„ì€ ë‹¬ë¼ì§‘ë‹ˆë‹¤. ì ˆëŒ€ ë²•ì  íŒë‹¨ì´ë‚˜ ìš´ì „ ì—¬ë¶€ì˜ ê·¼ê±°ë¡œ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.
            </div>
        </section>
    </div> <div id="journalContent" style="display:none;">
        <header>
            <div class="title">ğŸ“° ë””í†¡ìŠ¤ ì €ë„</div>
            <div class="subtitle">ê±´ê°•í•œ ì•Œì½”ì˜¬ ë¶„í•´ë¥¼ ë•ëŠ” ì •ë³´ë“¤ì„ ëª¨ì•˜ìŠµë‹ˆë‹¤.</div>
        </header>

        <section class="card">
            <div class="section-title">ì£¼ìš” ì½˜í…ì¸ </div>
            <ul class="journal-list">
                <li class="journal-item" data-id="top5foods">
                    <div class="journal-icon">ğŸ¥‘</div>
                    <div class="journal-content">
                        <h3>ìˆ™ì·¨ í•´ì†Œì— ì¢‹ì€ ìŒì‹ TOP 5</h3>
                        <p>ê°„ ê¸°ëŠ¥ì„ í™œì„±í™”í•˜ê³  íšŒë³µ ì†ë„ë¥¼ ë†’ì´ëŠ” ì‹ë‹¨ ì œì•ˆ</p>
                    </div>
                </li>
                <li class="journal-item" data-id="comparetime">
                    <div class="journal-icon">â±ï¸</div>
                    <div class="journal-content">
                        <h3>ì£¼ì¢…ë³„ ì•Œì½”ì˜¬ ë¶„í•´ ì‹œê°„ ë¹„êµ</h3>
                        <p>ì†Œì£¼, ë§¥ì£¼, ìœ„ìŠ¤í‚¤, ì™€ì¸ë³„ í•´ë… ì†ë„ ì°¨ì´ ë¶„ì„</p>
                    </div>
                </li>
                <li class="journal-item" data-id="safesleep">
                    <div class="journal-icon">ğŸ˜´</div>
                    <div class="journal-content">
                        <h3>ìŒì£¼ í›„ ì•ˆì „í•œ ìˆ˜ë©´ ê°€ì´ë“œ</h3>
                        <p>ì•Œì½”ì˜¬ì´ ìˆ˜ë©´ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ê³¼ ì˜¬ë°”ë¥¸ ìˆ˜ë©´ ìŠµê´€</p>
                    </div>
                </li>
            </ul>
        </section>
        
        <section style="height: 50px;"></section>
    </div> <div id="journalDetailPage" style="display:none;">
        <header>
            <a href="#journal" class="back-button" onclick="showTab('journal')">
                &larr; ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°
            </a>
            <h2 id="detailTitle" style="text-align: center; margin-top: 5px;"></h2>
        </header>
        
        <section class="card detail-card">
            <div id="detailContent">
                </div>
        </section>
        <section style="height: 50px;"></section>
    </div>

  </main>

  <nav class="tab-bar">
    <a href="#calculator" class="tab-item active" data-tab="calculator">
        <span>ğŸ§®</span>
        <span>ê³„ì‚°ê¸°</span>
    </a>
    <a href="#journal" class="tab-item" data-tab="journal">
        <span>ğŸ“°</span>
        <span>ë””í†¡ìŠ¤ ì €ë„</span>
    </a>
  </nav>

  <script>
    /***********************
     * ìƒìˆ˜ ë° ë°ì´í„°
     ***********************/
    const ALCOHOL_SPECIFIC_GRAVITY = 0.7894; 
    const ABSORPTION_RATE = 0.7;             
    const BETA = 0.015;                      

    const DRINK_DATA = {
      soju: { degree: 16.5, units: {'ì”':50,'ë³‘':360,'mL':1} },
      beer: { degree: 5.0, units: {'ìº”(500mL)':500,'ìº”(350mL)':350,'ë³‘(500mL)':500,'ë³‘(330mL)':330,'ì”(500mL)':500,'ì”(350mL)':350,'mL':1} },
      wine: { degree: 13.0, units: {'ì”':125,'ë³‘':750,'mL':1} },
      whiskey: { degree: 40.0, units: {'ìƒ·':30,'ë³‘':750,'mL':1} },
      custom: { degree: 0, units: {'mL':1} }
    };

    // ì €ë„ ì½˜í…ì¸  ë°ì´í„° (ì´ì „ê³¼ ë™ì¼)
    const JOURNAL_CONTENT = {
        top5foods: {
            title: "ìˆ™ì·¨ í•´ì†Œì— ì¢‹ì€ ìŒì‹ TOP 5",
            icon: "ğŸ¥‘",
            html: `
                <p>ìˆ™ì·¨ëŠ” ì•Œì½”ì˜¬ì´ ë¶„í•´ë˜ë©´ì„œ ìƒê¸°ëŠ” ì•„ì„¸íŠ¸ì•Œë°íˆë“œì™€ íƒˆìˆ˜ í˜„ìƒ, ì €í˜ˆë‹¹ ë“±ìœ¼ë¡œ ì¸í•´ ë°œìƒí•©ë‹ˆë‹¤. ë‹¤ìŒ ìŒì‹ë“¤ì€ ê°„ í•´ë…ê³¼ ìˆ˜ë¶„ ë³´ì¶©, ì „í•´ì§ˆ ê· í˜•ì— ë„ì›€ì„ ì¤ë‹ˆë‹¤.</p>

                <h3>1. ê³„ë€ ë° ë‹¨ë°±ì§ˆ ì‹í’ˆ</h3>
                <p>ê³„ë€ì—ëŠ” ì•„ì„¸íŠ¸ì•Œë°íˆë“œ í•´ë…ì— í•„ìš”í•œ ì•„ë¯¸ë…¸ì‚°ì¸ **ë©”í‹°ì˜¤ë‹Œ(Methionine)**ê³¼ **ì‹œìŠ¤í…Œì¸(Cysteine)**ì´ í’ë¶€í•©ë‹ˆë‹¤. ì´ëŠ” ê°„ì˜ í•´ë… ì‘ìš©ì„ ì´‰ì§„í•˜ì—¬ ìˆ™ì·¨ì˜ ì£¼ë²”ì¸ ì•„ì„¸íŠ¸ì•Œë°íˆë“œë¥¼ ë¹ ë¥´ê²Œ ë¶„í•´í•˜ëŠ” ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤.</p>
                
                <h3>2. ì½©ë‚˜ë¬¼ í•´ì¥êµ­</h3>
                <p>ì½©ë‚˜ë¬¼ì— ë“¤ì–´ìˆëŠ” **ì•„ìŠ¤íŒŒë¼ê¸´ì‚°(Aspartic Acid)**ì€ ê°€ì¥ ëŒ€í‘œì ì¸ í•´ë… ì„±ë¶„ì…ë‹ˆë‹¤. ì•„ìŠ¤íŒŒë¼ê¸´ì‚°ì€ ì•Œì½”ì˜¬ì˜ ëŒ€ì‚¬ì‚°ë¬¼ì„ ì œê±°í•˜ëŠ” íš¨ì†Œì˜ ìƒì„±ì„ ë•ê³ , ì•Œì½”ì˜¬ì´ ê°„ì— ë¯¸ì¹˜ëŠ” ë¶€ë‹´ì„ ì¤„ì—¬ì¤ë‹ˆë‹¤.</p>

                <h3>3. ë°”ë‚˜ë‚˜ ë° ê°ì</h3>
                <p>ì•Œì½”ì˜¬ì€ ì´ë‡¨ ì‘ìš©ì„ ì´‰ì§„í•˜ì—¬ ì¹¼ë¥¨ê³¼ ê°™ì€ ì£¼ìš” ì „í•´ì§ˆì„ ë°°ì¶œì‹œí‚¤ê³  ì €í˜ˆë‹¹ì„ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°”ë‚˜ë‚˜ì™€ ê°ìëŠ” **ì¹¼ë¥¨**ì´ í’ë¶€í•˜ê³  **ë³µí•© íƒ„ìˆ˜í™”ë¬¼**ì„ ì œê³µí•˜ì—¬ ì „í•´ì§ˆ ê· í˜•ì„ íšŒë³µí•˜ê³  ë–¨ì–´ì§„ í˜ˆë‹¹ì„ ì²œì²œíˆ ì˜¬ë ¤ì¤ë‹ˆë‹¤.</p>
                
                <h3>4. ê¿€ë¬¼ ë° ê³¼ì¼ ì£¼ìŠ¤</h3>
                <p>ê¿€ì— í•¨ìœ ëœ **ê³¼ë‹¹**ì€ ì•Œì½”ì˜¬ ë¶„í•´ íš¨ì†Œì˜ í™œì„±ë„ë¥¼ ë†’ì´ëŠ” ì—ë„ˆì§€ì›ìœ¼ë¡œ ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê³¼ì¼ ì£¼ìŠ¤ì˜ ë¹„íƒ€ë¯¼Cì™€ ë‹¹ë¶„ì€ ë¹ ë¥¸ ì—ë„ˆì§€ ë³´ì¶©ê³¼ íƒˆìˆ˜ í•´ì†Œì— íš¨ê³¼ì ì…ë‹ˆë‹¤.</p>

                <h3>5. ë¬¼ê³¼ ì´ì˜¨ìŒë£Œ</h3>
                <p>ì•Œì½”ì˜¬ ì„­ì·¨ í›„ ê°€ì¥ ì¤‘ìš”í•œ ê²ƒì€ **ìˆ˜ë¶„ ë³´ì¶©**ì…ë‹ˆë‹¤. ë‹¤ëŸ‰ì˜ ë¬¼ì€ íƒˆìˆ˜ë¥¼ ë§‰ê³ , ì²´ë‚´ ì•Œì½”ì˜¬ ë†ë„ë¥¼ í¬ì„ì‹œí‚¤ë©°, ì „í•´ì§ˆì´ í’ë¶€í•œ ì´ì˜¨ìŒë£ŒëŠ” ì†ì‹¤ëœ ë¯¸ë„¤ë„ì„ ë³´ì¶©í•˜ì—¬ íšŒë³µ ì†ë„ë¥¼ ë†’ì…ë‹ˆë‹¤.</p>
            `
        },
        comparetime: {
            title: "ì£¼ì¢…ë³„ ì•Œì½”ì˜¬ ë¶„í•´ ì‹œê°„ ë¹„êµ",
            icon: "â±ï¸",
            html: `
                <p>ì£¼ì¢…ë³„ í•´ë… ì‹œê°„ì€ ë„ìˆ˜(ì•Œì½”ì˜¬ ë†ë„)ì™€ ì„­ì·¨ëŸ‰ì— ì§ì ‘ì ìœ¼ë¡œ ë¹„ë¡€í•©ë‹ˆë‹¤. ê°™ì€ ì–‘ì˜ ìˆœìˆ˜ ì•Œì½”ì˜¬ì„ ì„­ì·¨í–ˆì„ ë•Œ, ë¶„í•´ ì†ë„ ìì²´ëŠ” ê°œì¸ë§ˆë‹¤ ë‹¤ë¥´ì§€ë§Œ, ì•Œì½”ì˜¬ ì–‘ì— ë”°ë¥¸ ì´ ë¶„í•´ ì‹œê°„ì„ ì¶”ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                
                <h3>ìˆœìˆ˜ ì•Œì½”ì˜¬ (Pure Alcohol) ê¸°ì¤€</h3>
                <p>ì„±ì¸ ë‚¨ì„±(70kg) ê¸°ì¤€, ìˆœìˆ˜ ì•Œì½”ì˜¬ 10g(ì•½ ì†Œì£¼ 1ì” ë˜ëŠ” ë§¥ì£¼ 1/4ìº”)ì„ ë¶„í•´í•˜ëŠ” ë° ì•½ 1ì‹œê°„ì´ ì†Œìš”ë©ë‹ˆë‹¤. ì´ëŠ” í‰ê· ì ì¸ ìˆ˜ì¹˜ì´ë©°, ì—¬ì„±ì€ ì²´ìˆ˜ë¶„ìœ¨ì´ ë‚®ì•„ ì‹œê°„ì´ ë” ì˜¤ë˜ ê±¸ë¦½ë‹ˆë‹¤.</p>
                
                <h3>ì£¼ì¢…ë³„ ì¶”ì • í•´ë… ì‹œê°„ (ì˜ˆì‹œ)</h3>
                <ul>
                    <li>**ì†Œì£¼ 1ë³‘ (16.5%):** ìˆœìˆ˜ ì•Œì½”ì˜¬ ì•½ 45g. ì•½ 4.5~6ì‹œê°„ ì¶”ì •.</li>
                    <li>**ë§¥ì£¼ 500cc (5.0%):** ìˆœìˆ˜ ì•Œì½”ì˜¬ ì•½ 20g. ì•½ 2~3ì‹œê°„ ì¶”ì •.</li>
                    <li>**ì™€ì¸ 1ë³‘ (13%):** ìˆœìˆ˜ ì•Œì½”ì˜¬ ì•½ 77g. ì•½ 7.5~10ì‹œê°„ ì¶”ì •.</li>
                    <li>**ìœ„ìŠ¤í‚¤ 3ìƒ· (40%):** ìˆœìˆ˜ ì•Œì½”ì˜¬ ì•½ 28g. ì•½ 2.8~4ì‹œê°„ ì¶”ì •.</li>
                </ul>
                <p><strong>ì°¸ê³ :</strong> í•´ë… ì‹œê°„ì€ ì•Œì½”ì˜¬ì´ ì²´ë‚´ì— ë‚¨ì•„ìˆëŠ” ì‹œê°„ì„ ë‚˜íƒ€ë‚´ë©°, ìš´ì „ ê°€ëŠ¥ ì—¬ë¶€ì™€ëŠ” ì§ì ‘ì ì¸ ê´€ë ¨ì´ ì—†ìŠµë‹ˆë‹¤. í•´ë… ì‹œê°„ì´ ëë‚¬ë‹¤ê³  í•´ì„œ ìš´ì „ì´ ì•ˆì „í•˜ë‹¤ëŠ” ì˜ë¯¸ëŠ” ì•„ë‹™ë‹ˆë‹¤.</p>
            `
        },
        safesleep: {
            title: "ìŒì£¼ í›„ ì•ˆì „í•œ ìˆ˜ë©´ ê°€ì´ë“œ",
            icon: "ğŸ˜´",
            html: `
                <p>ì•Œì½”ì˜¬ì€ ì¤‘ì¶”ì‹ ê²½ê³„ ì–µì œì œë¡œ ì‘ìš©í•˜ì—¬ ì¼ì‹œì ìœ¼ë¡œ ì ì„ ìœ ë„í•˜ì§€ë§Œ, ê¹Šì€ ìˆ˜ë©´(REM ìˆ˜ë©´) ë‹¨ê³„ë¥¼ ë°©í•´í•˜ì—¬ ìˆ˜ë©´ì˜ ì§ˆì„ ê¸‰ê²©íˆ ë–¨ì–´ëœ¨ë¦½ë‹ˆë‹¤. íŠ¹íˆ ì ë“  í›„ ëª‡ ì‹œê°„ ë’¤ì—ëŠ” ì•Œì½”ì˜¬ì´ ëŒ€ì‚¬ë˜ë©´ì„œ ë‚˜íƒ€ë‚˜ëŠ” ê°ì„± íš¨ê³¼ ë•Œë¬¸ì— ìˆ˜ë©´ ìœ ì§€ì— ì–´ë ¤ì›€ì„ ê²ªì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                
                <h3>ì•ˆì „í•˜ê³  ì§ˆ ì¢‹ì€ ìˆ˜ë©´ì„ ìœ„í•œ íŒ</h3>
                <ul>
                    <li>**ìŒì£¼ ìµœì†Œ 3ì‹œê°„ ì „ ê¸ˆì£¼:** ì ìë¦¬ì— ë“¤ê¸° ìµœì†Œ 3ì‹œê°„ ì „ì—ëŠ” ì•Œì½”ì˜¬ ì„­ì·¨ë¥¼ ì¤‘ë‹¨í•˜ì—¬ ëª¸ì´ ì•Œì½”ì˜¬ ëŒ€ì‚¬ë¥¼ ì‹œì‘í•  ì‹œê°„ì„ í™•ë³´í•©ë‹ˆë‹¤.</li>
                    <li>**ìˆ˜ë¶„ ë³´ì¶© í•„ìˆ˜:** ì ìë¦¬ì— ë“¤ê¸° ì „ ë¬¼ í•œ ì»µì„ ë§ˆì…” íƒˆìˆ˜ë¥¼ ì˜ˆë°©í•˜ê³ , ì•¼ê°„ì— ì•Œì½”ì˜¬ ëŒ€ì‚¬ë¥¼ ë•ìŠµë‹ˆë‹¤.</li>
                    <li>**ì ë“¤ê¸° ì „ ì•½ë¬¼ ì£¼ì˜:** ìˆ˜ë©´ì œë‚˜ ì§„ì •ì œ ë“± ë‹¤ë¥¸ ì•½ë¬¼ì„ ì•Œì½”ì˜¬ê³¼ í•¨ê»˜ ë³µìš©í•˜ë©´ í˜¸í¡ ì–µì œ ë“± ì¹˜ëª…ì ì¸ ë¶€ì‘ìš©ì„ ì¼ìœ¼í‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                    <li>**ë”°ëœ»í•œ ëª©ìš• ëŒ€ì‹  ìƒ¤ì›Œ:** í˜ˆê´€ì´ í™•ì¥ëœ ìƒíƒœì—ì„œ ëœ¨ê±°ìš´ ë¬¼ì— ì˜¤ë˜ ìˆìœ¼ë©´ í˜ˆì••ì´ ê¸‰ê²©íˆ ë³€ë™í•  ìˆ˜ ìˆìœ¼ë‹ˆ, ê°„ë‹¨í•œ ë¯¸ì§€ê·¼í•œ ìƒ¤ì›Œë§Œ ê¶Œì¥ë©ë‹ˆë‹¤.</li>
                </ul>
            `
        }
    };


    // DOM ìš”ì†Œ
    const unitTypeSelect = document.getElementById('unitType');
    const alcoholContentInput = document.getElementById('alcoholContent');
    const unitVolumeInput = document.getElementById('unitVolume');
    const displayML = document.getElementById('displayML');
    const calculateBtn = document.getElementById('calculateBtn');
    const resultOutput = document.getElementById('resultOutput');
    const resultInitial = document.getElementById('resultInitial');
    const calculatorContent = document.getElementById('calculatorContent');
    const journalContent = document.getElementById('journalContent');
    const journalDetailPage = document.getElementById('journalDetailPage'); 
    const detailTitle = document.getElementById('detailTitle');
    const detailContent = document.getElementById('detailContent');
    const tabItems = document.querySelectorAll('.tab-item');
    
    // ì‹œê°„ ì…ë ¥ í•„ë“œ DOM ìš”ì†Œ
    const inputYear = document.getElementById('inputYear');
    const inputMonth = document.getElementById('inputMonth');
    const inputDay = document.getElementById('inputDay');
    const inputHour = document.getElementById('inputHour');
    const inputMinute = document.getElementById('inputMinute');
    const inputDrinkingDuration = document.getElementById('inputDrinkingDuration'); // ì´ ìŒì£¼ ì‹œê°„ í•„ë“œ


    /***********************
     * ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
     ***********************/
    document.addEventListener('DOMContentLoaded', initApp);

    function initApp(){
      updateUI('soju');
      populateTimeInputs(); // ì‹œê°„ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
      populateDurationInput(); // ì´ ìŒì£¼ ì‹œê°„ í•„ë“œ ì´ˆê¸°í™”

      // ê³„ì‚°ê¸° ì…ë ¥ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      document.querySelectorAll('input[name="drinkType"]').forEach(r => {
        r.addEventListener('change', (e) => updateUI(e.target.value));
      });
      unitVolumeInput.addEventListener('input', updateConvertedVolume);
      unitTypeSelect.addEventListener('change', () => {
        updateConvertedVolume();
        updateUnitPlaceholder();
      });
      calculateBtn.addEventListener('click', calculateDetoxTime);

      // ì €ë„ ë¦¬ìŠ¤íŠ¸ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      document.querySelectorAll('.journal-item').forEach(item => {
          item.addEventListener('click', (e) => {
              const id = e.currentTarget.getAttribute('data-id');
              showJournalDetail(id);
          });
      });
      
      // íƒ­ ì „í™˜ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      tabItems.forEach(tab => {
          tab.addEventListener('click', handleTabClick);
      });
      
      // URL í•´ì‹œ ê¸°ë°˜ ì´ˆê¸° íƒ­ ì„¤ì •
      const initialHash = window.location.hash.substring(1) || 'calculator';
      showTab(initialHash);
      
      // ë‚ ì§œ/ì‹œê°„ ì„ íƒ ë³€ê²½ ì‹œ ë‚ ì§œ ìœ íš¨ì„± ê²€ì‚¬ (ì›”/ì¼)
      inputYear.addEventListener('change', updateDaysInMonth);
      inputMonth.addEventListener('change', updateDaysInMonth);
    }
    
    /***********************
     * ì‹œê°„ ì…ë ¥ í•„ë“œ ë¡œì§ 
     ***********************/
     function populateTimeInputs() {
        // í˜„ì¬ ì‹œê° ëŒ€ì‹  2025ë…„ 12ì›” 15ì¼ 13ì‹œ 59ë¶„ KSTë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•¨
        const now = new Date(); 
        const currentYear = now.getFullYear();
        const currentMonth = now.getMonth() + 1; 
        const currentDay = now.getDate();
        const currentHour = now.getHours();
        const currentMinute = now.getMinutes();

        // 1. ë…„ (5ë…„ ì „ë¶€í„° 1ë…„ í›„ê¹Œì§€)
        for (let y = currentYear - 5; y <= currentYear + 1; y++) {
            const option = document.createElement('option');
            option.value = y;
            option.textContent = `${y}ë…„`;
            if (y === currentYear) option.selected = true;
            inputYear.appendChild(option);
        }

        // 2. ì›”
        for (let m = 1; m <= 12; m++) {
            const option = document.createElement('option');
            option.value = m;
            option.textContent = `${m}ì›”`;
            if (m === currentMonth) option.selected = true;
            inputMonth.appendChild(option);
        }

        // 3. ì¼ (ì›” ì„ íƒì— ë”°ë¼ ë™ì ìœ¼ë¡œ ì±„ì›Œì§)
        updateDaysInMonth(); // ì´ˆê¸° ì¼ ì„¤ì •

        // 4. ì‹œ (00ì‹œ ~ 23ì‹œ)
        for (let h = 0; h <= 23; h++) {
            const hStr = h < 10 ? '0' + h : String(h);
            const option = document.createElement('option');
            option.value = h;
            option.textContent = `${hStr}ì‹œ`;
            if (h === currentHour) option.selected = true;
            inputHour.appendChild(option);
        }

        // 5. ë¶„ (00ë¶„ ~ 59ë¶„)
        for (let min = 0; min <= 59; min++) {
            const minStr = min < 10 ? '0' + min : String(min);
            const option = document.createElement('option');
            option.value = min;
            option.textContent = `${minStr}ë¶„`;
            if (min === currentMinute) option.selected = true;
            inputMinute.appendChild(option);
        }
    }
    
    // ì´ ìŒì£¼ ì‹œê°„ í•„ë“œ ì´ˆê¸°í™” (ìƒˆë¡œ ì¶”ê°€)
    function populateDurationInput() {
        inputDrinkingDuration.innerHTML = '';
        for (let h = 1; h <= 6; h++) {
            const option = document.createElement('option');
            option.value = h;
            option.textContent = `${h}ì‹œê°„`;
            if (h === 1) option.selected = true; // ë””í´íŠ¸ 1ì‹œê°„
            inputDrinkingDuration.appendChild(option);
        }
    }

    // ì›”ì— ë”°ë¼ ì¼ ìˆ˜ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
    function updateDaysInMonth() {
        const year = parseInt(inputYear.value);
        const month = parseInt(inputMonth.value);
        const currentSelectedDay = parseInt(inputDay.value) || 1;
        
        // í•´ë‹¹ ì›”ì˜ ë§ˆì§€ë§‰ ë‚ ì§œë¥¼ êµ¬í•¨ (JavaScript Date ê°ì²´ì˜ íŠ¸ë¦­)
        const daysInMonth = new Date(year, month, 0).getDate();

        inputDay.innerHTML = '';
        for (let d = 1; d <= daysInMonth; d++) {
            const option = document.createElement('option');
            option.value = d;
            option.textContent = `${d}ì¼`;
            
            // ê¸°ì¡´ì— ì„ íƒëœ ë‚ ì§œê°€ ìœ íš¨í•˜ë©´ ìœ ì§€, ì•„ë‹ˆë©´ 1ì¼ ì„ íƒ
            if (d === currentSelectedDay || (d === daysInMonth && currentSelectedDay > daysInMonth)) {
                option.selected = true;
            }
            inputDay.appendChild(option);
        }
    }

    // ì…ë ¥ëœ ì‹œê°ì„ Date ê°ì²´ë¡œ íŒŒì‹±í•˜ëŠ” í•¨ìˆ˜
    function parseInputTime() {
        const y = parseInt(inputYear.value);
        const m = parseInt(inputMonth.value) - 1; // JS month is 0-indexed
        const d = parseInt(inputDay.value);
        const h = parseInt(inputHour.value);
        const min = parseInt(inputMinute.value);
        
        return new Date(y, m, d, h, min, 0);
    }


    /***********************
     * íƒ­ ë° í˜ì´ì§€ ì „í™˜ ë¡œì§ (ì´ì „ê³¼ ë™ì¼)
     ***********************/
    function handleTabClick(e) {
        e.preventDefault();
        const tabName = e.currentTarget.getAttribute('data-tab');
        history.pushState(null, '', `#${tabName}`);
        showTab(tabName);
    }

    function showTab(tabName) {
        calculatorContent.style.display = 'none';
        journalContent.style.display = 'none';
        journalDetailPage.style.display = 'none'; 

        if (tabName === 'calculator') {
            calculatorContent.style.display = 'block';
            document.title = 'ğŸº ì•Œì½”ì˜¬ í•´ë… ê³„ì‚°ê¸°';
        } else if (tabName === 'journal') {
            journalContent.style.display = 'block';
            document.title = 'ğŸ“° ë””í†¡ìŠ¤ ì €ë„';
        }

        tabItems.forEach(tab => {
            tab.classList.remove('active');
            if (tab.getAttribute('data-tab') === tabName) {
                tab.classList.add('active');
            }
        });
        
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    
    function showJournalDetail(id) {
        const content = JOURNAL_CONTENT[id];
        if (!content) return;

        calculatorContent.style.display = 'none';
        journalContent.style.display = 'none';
        
        journalDetailPage.style.display = 'block';
        detailTitle.textContent = content.title;
        detailContent.innerHTML = content.html;
        document.title = content.title;
        
        history.pushState(null, '', `#journal-detail`); 
        
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    /***********************
     * ê³„ì‚°ê¸° UI ë° ë¡œì§
     ***********************/

    function updateUI(selectedDrink){
        const info = DRINK_DATA[selectedDrink] || DRINK_DATA.custom;

        if(selectedDrink === 'custom'){
            alcoholContentInput.value = '';
            alcoholContentInput.placeholder = 'ë„ìˆ˜ë¥¼ ì§ì ‘ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: 12.5)';
        } else {
            if(!alcoholContentInput.value || alcoholContentInput.value === '' || Number(alcoholContentInput.value) === 0){
                alcoholContentInput.value = info.degree;
            } else {
                alcoholContentInput.value = info.degree;
            }
        }

        unitTypeSelect.innerHTML = '';
        Object.keys(info.units).forEach(unit => {
            const opt = document.createElement('option');
            opt.value = unit;
            opt.textContent = unit;
            unitTypeSelect.appendChild(opt);
        });

        updateUnitPlaceholder();
        updateConvertedVolume();
    }

    function updateUnitPlaceholder(){
        const unit = unitTypeSelect.value;
        if(unit === 'mL'){
            unitVolumeInput.placeholder = 'ì´ ìš©ëŸ‰ (mL) ì…ë ¥';
        } else {
            unitVolumeInput.placeholder = 'ìˆ˜ëŸ‰ ì…ë ¥ (ì˜ˆ: 2)';
        }
    }

    function updateConvertedVolume(){
        const selectedDrink = document.querySelector('input[name="drinkType"]:checked').value;
        const info = DRINK_DATA[selectedDrink] || DRINK_DATA.custom;

        const unit = unitTypeSelect.value;
        const qty = parseFloat(unitVolumeInput.value);
        if(isNaN(qty) || qty <= 0){
            displayML.textContent = '0';
            return;
        }
        const unitML = info.units[unit] || 0;
        const totalML = qty * unitML;
        displayML.textContent = Math.round(totalML);
    }

    // ì‹œê° í¬ë§· í•¨ìˆ˜
    function formatKoreanDatetime(date, isSentence = false){
        const year = date.getFullYear();
        const month = date.getMonth() + 1;
        const day = date.getDate();
        let hour = date.getHours();
        const minute = date.getMinutes();

        const ampm = hour >= 12 ? 'ì˜¤í›„' : 'ì˜¤ì „';
        hour = hour % 12;
        hour = hour ? hour : 12;
        const minuteStr = minute < 10 ? '0' + minute : minute;

        const baseFormat = `${year}ë…„ ${month}ì›” ${day}ì¼ ${ampm} ${hour}ì‹œ ${minuteStr}`;
        
        if (isSentence) {
            // ë¬¸ì¥ ì¶œë ¥ ì‹œëŠ” 'ë¶„' ë‹¨ìœ„ë¥¼ ìƒëµí•˜ê³  ë°˜í™˜
            return baseFormat; 
        } else {
            // ê¸°ë³¸ ì¶œë ¥ ì‹œëŠ” 'ë¶„' ë‹¨ìœ„ê¹Œì§€ í¬í•¨
            return `${baseFormat}ë¶„`;
        }
    }

    function calculateDetoxTime(){
        const gender = document.querySelector('input[name="gender"]:checked').value;
        const P = parseFloat(document.getElementById('weight').value); 
        const alcoholContent = parseFloat(alcoholContentInput.value); 
        const unitVolume = parseFloat(unitVolumeInput.value);
        const selectedDrink = document.querySelector('input[name="drinkType"]:checked').value;
        const unit = unitTypeSelect.value;
        const info = DRINK_DATA[selectedDrink] || DRINK_DATA.custom;
        const unitML = info.units[unit] || 0;
        const totalVolumeML = (isNaN(unitVolume) || unitVolume <= 0) ? 0 : unitVolume * unitML;
        
        const startTime = parseInputTime();
        // ì´ ìŒì£¼ ì‹œê°„ (ì‹œê°„ ë‹¨ìœ„)
        const drinkingDurationHours = parseFloat(inputDrinkingDuration.value); 

        if(isNaN(P) || P <= 0){ showError("ì²´ì¤‘ì„ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš” (kg)."); return; }
        if(isNaN(alcoholContent) || alcoholContent < 0){ showError("ë„ìˆ˜ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš” (%)."); return; }
        if(totalVolumeML <= 0){ showError("ì„­ì·¨ëŸ‰ì„ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”."); return; }
        if(isNaN(drinkingDurationHours) || drinkingDurationHours <= 0){ showError("ì´ ìŒì£¼ ì‹œê°„ì„ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”."); return; }


        const R = (gender === 'male') ? 0.86 : 0.64;
        const pureAlcoholGrams = totalVolumeML * (alcoholContent / 100) * ALCOHOL_SPECIFIC_GRAVITY * ABSORPTION_RATE;
        const C0 = pureAlcoholGrams / (P * R * 10); // ìµœëŒ€ ì ì¬ BAC

        // ì¥ì‹œê°„ ìŒì£¼ì— ë”°ë¥¸ BAC ê°ì†Œë¶„ ê³„ì‚° (ì´ë¯¸ ì œê±°ëœ ì•Œì½”ì˜¬)
        const alcoholRemovedDuringDrinking = BETA * drinkingDurationHours;
        
        // ì‹¤ì œ í•´ë…ì´ ì‹œì‘ë  BAC (peak BAC)
        let C_peak = C0 - alcoholRemovedDuringDrinking; 

        if (C_peak < 0) {
            // ìŒì£¼í•˜ëŠ” ë™ì•ˆ ì•Œì½”ì˜¬ì´ ëª¨ë‘ ì œê±°ë˜ì–´ BACê°€ 0 ì•„ë˜ë¡œ ë‚´ë ¤ê°ˆ ê²½ìš°
            C_peak = 0.0001; 
        }

        if(C_peak < 0.0001){ showSmallResult("ì„­ì·¨ëŸ‰ì´ ë§¤ìš° ì ê±°ë‚˜ ìŒì£¼ ì‹œê°„ì´ ê¸¸ì–´ í˜ˆì¤‘ ì•Œì½”ì˜¬ ë†ë„ ì¶”ì •ì¹˜ê°€ ê±°ì˜ 0%ì…ë‹ˆë‹¤."); return; }

        // ìµœì¢… í•´ë… ì‹œê°„ ê³„ì‚° (peak BAC ê¸°ì¤€)
        const T_hours = C_peak / BETA; 
        const hoursPart = Math.floor(T_hours);
        const minutesPart = Math.round((T_hours - hoursPart) * 60);

        const detoxDurationMs = T_hours * 3600 * 1000;
        const completionTime = new Date(startTime.getTime() + detoxDurationMs);
        
        const now = startTime; 

        renderResult({
            now, completionTime, T_hours, hoursPart, minutesPart, pureAlcoholGrams, C_peak
        });
    }

    function renderResult({now, completionTime, T_hours, hoursPart, minutesPart, pureAlcoholGrams, C_peak}){
        resultInitial.style.display = 'none';
        resultOutput.style.display = 'block';

        const completionTimeSentenceFormat = formatKoreanDatetime(completionTime, true); 
        
        const completionDisplay = `
            í•´ë… ì™„ë£Œ ì˜ˆìƒ ì‹œê°ì€<br>
            <strong style="color: var(--primary);">${completionTimeSentenceFormat}ë¶„ì´ì—ìš”.</strong>
        `;

        resultOutput.innerHTML = `
            <div class="section-title">â³ í•´ë… ì‹œê°„ ì¶”ì • ê²°ê³¼</div>

            <div class="result">
                <div class="big">${hoursPart}ì‹œê°„ ${minutesPart}ë¶„</div>
                
                <div class="sub" style="font-size: 1.1rem; line-height: 1.5;">${completionDisplay}</div>

                <div class="meta" style="margin-top:15px;">
                    <div><strong>ì¸¡ì • ì‹œì‘ ì‹œê°</strong><div style="color:#4B5860">${formatKoreanDatetime(now, false)}</div></div>
                    <div><strong>ìˆœìˆ˜ ì•Œì½”ì˜¬</strong><div style="color:#4B5860">${pureAlcoholGrams.toFixed(1)} g</div></div>
                    <div><strong>ìµœëŒ€ BAC(ì¶”ì •)</strong><div style="color:#4B5860">${(C_peak).toFixed(4)}%</div></div>
                </div>

                <div style="margin-top:10px;">
                    ${getDangerNoteHTML(C_peak)}
                </div>
            </div>
        `;
        setTimeout(()=>{ resultOutput.scrollIntoView({behavior:'smooth', block:'center'}); }, 120);
    }

    function getDangerNoteHTML(C0){
        const c = C0;
        let note = '';
        if(c >= 0.08){
            note = `<div style="background:#FFF7F6;border-left:6px solid ${'#E74C3C'};padding:10px;border-radius:8px;color:#7A2B2B;font-weight:600">
                    í˜ˆì¤‘ ì•Œì½”ì˜¬ ë†ë„ê°€ ë†’ìŠµë‹ˆë‹¤. ì ˆëŒ€ ìš´ì „í•˜ê±°ë‚˜ ìœ„í—˜í•œ ê¸°ê³„ ì¡°ì‘ì„ í•˜ì§€ ë§ˆì„¸ìš”.
                    </div>`;
        } else if(c >= 0.05){
            note = `<div style="background:#FFF9F3;border-left:6px solid ${'#E69500'};padding:10px;border-radius:8px;color:#7A4A12;font-weight:600">
                    ì£¼ì˜: í˜ˆì¤‘ ì•Œì½”ì˜¬ ë†ë„ê°€ ì¤‘ê°„ ìˆ˜ì¤€ì…ë‹ˆë‹¤. ì¶©ë¶„í•œ íœ´ì‹ê³¼ ìˆ˜ë¶„ ì„­ì·¨ê°€ í•„ìš”í•©ë‹ˆë‹¤.
                    </div>`;
        } else {
            note = `<div style="background:#F5FFFA;border-left:6px solid ${'#27AE60'};padding:10px;border-radius:8px;color:#115B41;font-weight:600">
                    ì €ìˆ˜ì¤€: íšŒë³µê¹Œì§€ ì‹œê°„ì´ í•„ìš”í•  ìˆ˜ ìˆìœ¼ë‹ˆ ë¬´ë¦¬í•˜ì§€ ë§ˆì„¸ìš”.
                    </div>`;
        }
        return note;
    }

    function showError(msg){
        resultInitial.style.display = 'none';
        resultOutput.style.display = 'block';
        resultOutput.innerHTML = `
            <div class="section-title">âš ï¸ ì…ë ¥ ì˜¤ë¥˜</div>
            <div style="color:${'#A83A3A'};font-weight:700">${msg}</div>
        `;
    }

    function showSmallResult(msg){
        resultInitial.style.display = 'none';
        resultOutput.style.display = 'block';
        resultOutput.innerHTML = `
            <div class="section-title">âœ… ê²°ê³¼</div>
            <div style="color:#2D6F32;font-weight:700">${msg}</div>
        `;
    }
  </script>
</body>
</html>